Subject: CVE-2019-12110: upnp_redirect(): accept NULL desc argument
Author: Thomas Bernard <miniupnp@free.fr>
Date: Tue, 18 Dec 2018 22:59:18 +0100
Last-Update: 2019-06-07
Bug-Debian: https://bugs.debian.org/930050

diff --git a/miniupnpd/upnpredirect.c b/miniupnpd/upnpredirect.c
index 7c179b62..74926f08 100644
--- a/upnpredirect.c
+++ b/upnpredirect.c
@@ -356,6 +356,10 @@ upnp_redirect(const char * rhost, unsigned short eport,
 		                 "%hu->%s:%hu %s", eport, iaddr, iport, protocol);
 		return -3;
 	}
+
+	if (desc == NULL)
+		desc = "";	/* assume empty description */
+
 	/* IGDv1 (WANIPConnection:1 Service Template Version 1.01 / Nov 12, 2001)
 	 * - 2.2.20.PortMappingDescription :
 	 *  Overwriting Previous / Existing Port Mappings:
