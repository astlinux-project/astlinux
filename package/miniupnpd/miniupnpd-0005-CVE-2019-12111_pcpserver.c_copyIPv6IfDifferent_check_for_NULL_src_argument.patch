Subject: CVE-2019-12111 pcpserver.c: copyIPv6IfDifferent() check for NULL src argument
Author: Thomas Bernard <miniupnp@free.fr>
Date: Tue, 18 Dec 2018 23:04:14 +0100
Origin: https://github.com/miniupnp/miniupnp/commit/cb8a02af7a5677cf608e86d57ab04241cf34e24f.patch
Last-Update: 2019-06-07
Bug-Debian: https://bugs.debian.org/930050

diff --git a/miniupnpd/pcpserver.c b/miniupnpd/pcpserver.c
index 9acfb44f..a964aa9f 100644
--- a/pcpserver.c
+++ b/pcpserver.c
@@ -177,7 +177,7 @@ static const char * getPCPOpCodeStr(uint8_t opcode)
  * buffers are same */
 static void copyIPv6IfDifferent(void * dest, const void * src)
 {
-	if(dest != src) {
+	if(dest != src && src != NULL) {
 		memcpy(dest, src, sizeof(struct in6_addr));
 	}
 }
