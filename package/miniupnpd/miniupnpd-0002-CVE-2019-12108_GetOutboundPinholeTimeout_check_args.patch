Subject: CVE-2019-12108: GetOutboundPinholeTimeout: check args
Author: Thomas Bernard <miniupnp@free.fr>
Date: Tue, 18 Dec 2018 22:54:51 +0100
Origin: upstream, https://github.com/miniupnp/miniupnp/commit/13585f15c7f7dc28bbbba1661efb280d530d114c.patch
Last-Update: 2019-06-07
Bug-Debian: https://bugs.debian.org/930050

Index: miniupnpd/upnpsoap.c
===================================================================
--- miniupnpd.orig/upnpsoap.c
+++ miniupnpd/upnpsoap.c
@@ -1842,6 +1842,13 @@ GetOutboundPinholeTimeout(struct upnphtt
 	rem_port = GetValueFromNameValueList(&data, "RemotePort");
 	protocol = GetValueFromNameValueList(&data, "Protocol");
 
+	if (!int_port || !ext_port || !protocol)
+	{
+		ClearNameValueList(&data);
+		SoapError(h, 402, "Invalid Args");
+		return;
+	}
+
 	rport = (unsigned short)atoi(rem_port);
 	iport = (unsigned short)atoi(int_port);
 	/*proto = atoi(protocol);*/
