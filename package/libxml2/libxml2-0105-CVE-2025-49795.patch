From c24909ba2601848825b49a60f988222da3019667 Mon Sep 17 00:00:00 2001
From: Michael Mann <mmann78@netscape.net>
Date: Sat, 21 Jun 2025 12:11:30 -0400
Subject: [PATCH] Schematron: Fix null pointer dereference leading to DoS

(CVE-2025-49795)

Fixes #932
---
 schematron.c                   |  5 +++++

diff --git a/schematron.c b/schematron.c
index 21e9956bb..33e924a0a 100644
--- a/schematron.c
+++ b/schematron.c
@@ -1483,6 +1483,11 @@ xmlSchematronFormatReport(xmlSchematronValidCtxtPtr ctxt,
             select = xmlGetNoNsProp(child, BAD_CAST "select");
             comp = xmlXPathCtxtCompile(ctxt->xctxt, select);
             eval = xmlXPathCompiledEval(comp, ctxt->xctxt);
+            if (eval == NULL) {
+                xmlXPathFreeCompExpr(comp);
+                xmlFree(select);
+                return ret;
+            }
 
             switch (eval->type) {
             case XPATH_NODESET: {
-- 
GitLab

